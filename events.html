<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b0b0b" />
  <title>Calendar | Dr Rihana Speaks</title>
  <link rel="stylesheet" href="assets/css/styles.css" />
</head>
<body>
<a class="skip-link" href="#main">Skip to content</a>
<header class="site-header">
  <div class="container navbar">
    <a class="brand" href="index.html" aria-label="Dr Rihana Speaks home">
      <img src="assets/images/dr-rihana-image-2.png" alt="Dr Rihana Speaks Logo" class="brand-logo">
    </a>

    <button class="menu-toggle" aria-label="Open menu">☰</button>

    <nav class="nav-links" aria-label="Primary">
      <a data-nav href="index.html">Home</a>
      <a data-nav href="books.html">Books</a>
      <a data-nav href="speaking.html">Speaking</a>
      <a data-nav href="events.html">Calendar</a>
    </nav>
  </div>
</header>

<div class="mobile-menu">
  <a href="index.html">Home</a>
  <a href="books.html">Books</a>
  <a href="speaking.html">Speaking</a>
  <a href="events.html">Calendar</a>
</div>


<main id="main">

<section>
  <div class="container">
    <div class="section-title">
      <h2>Speaking Calendar</h2>
      <p>See upcoming public events and appearances.</p>
    </div>

    <div class="gcal-embed" aria-label="Dr Rihana Speaks Google Calendar">
      <!-- Paste your Google Calendar iframe HERE -->
      <iframe
        src="https://calendar.google.com/calendar/embed?src=e4e26a2fc07fe227211384a44ecf11b6efe5c948b412c183db560aa2e096e831%40group.calendar.google.com&ctz=America%2FNew_York" style="border: 0" width="800" height="600" frameborder="0" scrolling="no">
        style="border:0"
        width="800"
        height="600"
        frameborder="0"
        scrolling="no"
        title="Dr Rihana Speaks Calendar"
      ></iframe>
    </div>
  </div>
</section>

<script src="assets/js/events.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const calendarEl = document.getElementById('calendar');
  const listEl = document.getElementById('eventList');

  async function getEvents() {
    try {
      const res = await fetch('assets/data/events.json', { cache: 'no-store' });
      if (!res.ok) throw new Error('Failed to load events.json');
      const data = await res.json();
      if (Array.isArray(data)) return data;
      if (data && Array.isArray(data.events)) return data.events;
      return [];
    } catch (e) {
      // Fallback if JSON isn't available yet
      return (window.DRS_EVENTS || []).slice();
    }
  }

  function renderList(events) {
    if (!listEl) return;
    if (!events.length) {
      listEl.innerHTML = '<div class="help">No events listed yet.</div>';
      return;
    }

    const sorted = events.slice().sort((a,b) => (a.start || '').localeCompare(b.start || ''));
    listEl.innerHTML = sorted.map(ev => {
      const start = ev.start ? new Date(ev.start).toLocaleDateString(undefined, { year:'numeric', month:'short', day:'numeric' }) : '';
      const title = ev.title || 'Event';
      const where = ev.location ? ` • ${ev.location}` : '';
      const linkOpen = ev.url ? `<a href="${ev.url}" target="_blank" rel="noopener">Details →</a>` : '';
      return `<div class="card" style="padding:14px">
        <div style="display:flex;justify-content:space-between;gap:14px;align-items:baseline;flex-wrap:wrap">
          <div><strong>${title}</strong><div class="help">${start}${where}</div></div>
          <div>${linkOpen}</div>
        </div>
      </div>`;
    }).join('');
  }

  getEvents().then(events => {
    const cal = new FullCalendar.Calendar(calendarEl, {
      initialView: 'dayGridMonth',
      height: 'auto',
      events,
      eventClick: function(info) {
        if (info.event.url) {
          info.jsEvent.preventDefault();
          window.open(info.event.url, '_blank', 'noopener');
        }
      }
    });
    cal.render();
    renderList(events);
  });
});
</script>

</main>

<footer class="footer">
  <div class="container footer-grid">
    <div>
      <div class="brand-name">Dr Rihana Speaks</div>
      <small>© <span data-year></span> Dr Rihana Speaks. All rights reserved.</small>
    </div>
  </div>
</footer>

<script src="assets/js/main.js"></script>
</body>
</html>
